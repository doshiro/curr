<!DOCTYPE html>
<html moznomarginboxes=""><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><title>Feature: Adding Collisions</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="bootstrap.css" title="default"/><link rel="stylesheet" type="text/css" href="pretty-printing.css" title="default"/><link rel="stylesheet" type="text/css" href="codemirror.css" title="default"/><link rel="stylesheet" type="text/css" href="scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="textbook.css" title="default"/><script type="text/javascript" src="scribble-common.js"></script><script type="text/javascript" src="codemirror.js"></script><script type="text/javascript" src="runmode.js"></script><script type="text/javascript" src="scheme2.js"></script><script type="text/javascript" src="pyret-mode.js"></script><script type="text/javascript" src="bootstraplesson.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML%2Chttp%3A%2F%2Fwww.cs.wpi.edu%2F%7Ekfisler%2Fmathjaxlocal.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="mature"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;">&bull;</td><td></td><td><a href="" class="tocviewselflink" data-pltdoc="x">Feature:<span class="mywbr"> &nbsp;</span> Adding Collisions</a></td></tr></table></div></div></div><div class="tocsub"><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber"></span><a href="#%28part._.Feature__.Adding_.Collisions%29" class="tocsubseclink" data-pltdoc="x">Feature:<span class="mywbr"> &nbsp;</span> Adding Collisions</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><a name="(part._.Feature__.Adding_.Collisions)"></a><p><script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script><noscript></noscript><script type="text/javascript" src="easyXDM.min.js"></script><noscript></noscript><script type="text/javascript" src="json2.min.js"></script><noscript></noscript><script type="text/javascript" src="wescheme-embedded.js"></script><noscript></noscript><script type="text/javascript" src="bootstrap-helpers.js"></script><noscript></noscript></p><div class="headercontent"><span class="BootstrapTitle"><img src="pict.png" alt="image" width="150" height="150"/><span class="TitleUnitNum">Feature</span>Adding Collisions</span></div><div class="SubFlow" id="overviewDescr"><span class="BootstrapHeader">Unit Overview</span><p>Using what they know from Bootstrap:Algebra, students write a distance function and collision detection function to handle collisions in their games, this time using the Data Structures and Reactor from their games.</p></div><blockquote class="OverviewBoundary"><iframe id="forum_embed"></iframe><div class="summary"><div class="" id="BootstrapAgenda"><p>Agenda</p><ul class="BootstrapAgendaList"><li class="BootstrapAgendaListItem"><p><span class="BSLessonDuration">30 min</span><a href="#lesson_TheDistanceFormula29651"><span class="BSLessonName">The Distance Formula</span></a></p></li><li class="BootstrapAgendaListItem"><p><span class="BSLessonDuration">30 min</span><a href="#lesson_CollisionDetection29652"><span class="BSLessonName">Collision Detection</span></a></p></li></ul></div><p><span href="../../../../reactive/english/units/Collisions/index.html" class="TranslationButton">English</span></p><p><span href="#" class="TranslationButton">add translation</span></p><div id="ProductOutcomes" class=" "><span class="BootstrapHeader">Product Outcomes:</span><ul><li><p>Students add collision-detection to their games</p></li></ul></div><div id="LearningObjectives" class=" "><span class="BootstrapHeader">Standards and Evidence Statements:</span><p>Standards with prefix BS are specific to Bootstrap; others are from the Common Core. Mouse over each standard to see its corresponding evidence statements. Our <a href="http://www.bootstrapworld.org/materials/Standards.shtml" target="_blank">Standards Document</a> shows which units cover each standard. </p><ul class="LearningObjectivesList"><li class="LearningObjectivesListItem"><div class="LearningObjectivesListItemContents"><p><span style="font-weight: bold">8.F.1-3</span>: The student defines, evaluates, and compares functions</p><ul class="EvidenceStatementsList"></ul></div></li><li class="LearningObjectivesListItem"><div class="LearningObjectivesListItemContents"><p><span style="font-weight: bold">8.G.6-8</span>: The student uses the Pythagorean Theorem to solve real-world and mathematical problems</p><ul class="EvidenceStatementsList"><li class="EvidenceStatementsListItem"><p> explanation of a proof of the Pythagorean Theorem and its converse</p></li><li class="EvidenceStatementsListItem"><p> application of the Pythagorean Theorem to determine unknown side lengths in right triangles in real-world and mathematical problems in two and three dimensions</p></li><li class="EvidenceStatementsListItem"><p> application of the Pythagorean Theorem to find the distance between two points in a coordinate system</p></li></ul></div></li><li class="LearningObjectivesListItem"><div class="LearningObjectivesListItemContents"><p><span style="font-weight: bold">A-CED.1-4</span>: The student solves equations and inequalities in one or more variable that describe numbers or relationships</p><ul class="EvidenceStatementsList"></ul></div></li><li class="LearningObjectivesListItem"><div class="LearningObjectivesListItemContents"><p><span style="font-weight: bold">A-SSE.1-2</span>: The student interprets the structure of expressions to solve problems in context</p><ul class="EvidenceStatementsList"></ul></div></li><li class="LearningObjectivesListItem"><div class="LearningObjectivesListItemContents"><p><span style="font-weight: bold">F-IF.1-3</span>: The student uses function notation to describe, evaluate, and interpret functions in terms of domain and range</p><ul class="EvidenceStatementsList"></ul></div></li><li class="LearningObjectivesListItem"><div class="LearningObjectivesListItemContents"><p><span style="font-weight: bold">F-LE.5</span>: The student interprets expressions for functions in terms of the situations they model</p><ul class="EvidenceStatementsList"></ul></div></li><li class="LearningObjectivesListItem"><div class="LearningObjectivesListItemContents"><p><span style="font-weight: bold">BS-CE</span>: The student translates between structured expressions as arithmetic, code, and Circles of Evaluation</p><ul class="EvidenceStatementsList"><li class="EvidenceStatementsListItem"><p>translating a Circle of Evaluation into its equivalent programming syntax</p></li></ul></div></li><li class="LearningObjectivesListItem"><div class="LearningObjectivesListItemContents"><p><span style="font-weight: bold">BS-DR.1</span>: The student is able to translate a word problem into a Contract and Purpose Statement</p><ul class="EvidenceStatementsList"><li class="EvidenceStatementsListItem"><p>given a word problem, identify the domain and range of a function</p></li><li class="EvidenceStatementsListItem"><p>given a word problem, write a Purpose Statement (i.e. - rewrite the problem in their own words)</p></li></ul></div></li><li class="LearningObjectivesListItem"><div class="LearningObjectivesListItemContents"><p><span style="font-weight: bold">BS-DR.2</span>: The student can derive test cases for a given contract and purpose statement</p><ul class="EvidenceStatementsList"><li class="EvidenceStatementsListItem"><p>given a Contract and a Purpose Statement, write multiple examples or test cases</p></li><li class="EvidenceStatementsListItem"><p>given multiple examples, identify patterns in order to label and name the variables</p></li></ul></div></li><li class="LearningObjectivesListItem"><div class="LearningObjectivesListItemContents"><p><span style="font-weight: bold">BS-DR.3</span>: Given multiple test cases, the student can define a function</p><ul class="EvidenceStatementsList"><li class="EvidenceStatementsListItem"><p>given examples and labeled variable(s), define the function</p></li></ul></div></li><li class="LearningObjectivesListItem"><div class="LearningObjectivesListItemContents"><p><span style="font-weight: bold">BS-DR.4</span>: The student can solve word problems that involve data structures</p><ul class="EvidenceStatementsList"><li class="EvidenceStatementsListItem"><p>write piecewise functions that consume and produce data structures</p></li></ul></div></li><li class="LearningObjectivesListItem"><div class="LearningObjectivesListItemContents"><p><span style="font-weight: bold">BS-M</span>: The student models a problem in context and determines the data needed to describe the problem</p><ul class="EvidenceStatementsList"><li class="EvidenceStatementsListItem"><p>identifying which quantities are fixed and which are variable</p></li></ul></div></li><li class="LearningObjectivesListItem"><div class="LearningObjectivesListItemContents"><p><span style="font-weight: bold">BS-PL.3</span>: The student is able to use the syntax of the programming language to define values and functions</p><ul class="EvidenceStatementsList"><li class="EvidenceStatementsListItem"><p>writing test cases</p></li><li class="EvidenceStatementsListItem"><p>defining and using functions</p></li></ul></div></li><li class="LearningObjectivesListItem"><div class="LearningObjectivesListItemContents"><p><span style="font-weight: bold">BS-PL.4</span>: The student is familiar with the syntax for conditionals</p><ul class="EvidenceStatementsList"><li class="EvidenceStatementsListItem"><p>defining and using functions than involve conditionals</p></li></ul></div></li><li class="LearningObjectivesListItem"><div class="LearningObjectivesListItemContents"><p><span style="font-weight: bold">BS-R</span>: The student is able to write interactive programs using the &rsquo;Reactor&rsquo; construct</p><ul class="EvidenceStatementsList"><li class="EvidenceStatementsListItem"><p>identify how functions work together to create and maintain a complex program</p></li></ul></div></li></ul></div><span class="BootstrapHeader">Length: 60 Minutes</span><div id="Glossary" class=" "><span class="BootstrapHeader">Glossary:</span><ul><li><p><span class="vocab">helper function</span>: A small function that handles a specific part of another computation, and gets called from other functions</p></li><li><p><span class="vocab">hypotenuse</span>: the side opposite the 90-degree angle in a right triangle</p></li></ul></div><div id="Materials" class=" "><span class="BootstrapHeader">Materials:</span><ul><li><p>Pens/pencils for the students, fresh whiteboard markers for teachers</p></li><li><p>Class poster (List of rules, design recipe, course calendar)</p></li><li><p>Editing environment (Pyret Editor)</p></li><li><p>Student workbooks</p></li><li><p>Language Table</p></li><li><p>Cutouts of Cat and Dog images</p></li><li><p>Cutouts of Pythagorean Theorem packets [<a href="../../resources/images/pythag1.png" target="_blank">1</a>, <a href="../../resources/images/pythag2.png" target="_blank">2</a>] - 1 per cluster</p></li><li><p>Student Games <span style="font-style: italic">or</span> the <a href="https://code.pyret.org/editor#share=0B9rKDmABYlJVT1FBd3RpQWFqbGM" target="_blank">Pyret Ninja Cat Starter</a> file preloaded on students&rsquo; machines</p></li></ul></div><div id="Preparation" class=" "><span class="BootstrapHeader">Preparation:</span><ul></ul></div><div id="LanguageTable" class=" "><table cellspacing="0" cellpadding="0" class="thetable"><tr><td align="center" class="BootstrapTable"><p class="BootstrapTableHeader">Types</p></td><td align="center" class="BootstrapTable"><p class="BootstrapTableHeader">Functions</p></td><td align="center" class="BootstrapTable"><p class="BootstrapTableHeader">Values</p></td></tr><tr><td align="center" class="BootstrapTable"><p>Number</p></td><td align="center" class="BootstrapTable"><p><tt class="pyret">+ - * / sqr sqrt expt</tt></p></td><td align="center" class="BootstrapTable"><p>1 ,4 ,44.6</p></td></tr><tr><td align="center" class="BootstrapTable"><p>String</p></td><td align="center" class="BootstrapTable"><p><tt class="pyret">string-append string-length</tt></p></td><td align="center" class="BootstrapTable"><p> "hello" </p></td></tr><tr><td align="center" class="BootstrapTable"><p>Image</p></td><td align="center" class="BootstrapTable"><p><tt class="pyret">rectangle circle triangle ellipse star scale rotate put-image</tt></p></td><td align="center" class="BootstrapTable"><p>(circle 25 "solid" "red")</p></td></tr></table></div><p><div id="lessonToolbar" class="fixed"><input type="button" valueShow="Show Teacher Notes" valueHide="Hide Teacher Notes" value="Show Teacher Notes" onclick="toggleTeacherNotes(this);"></input><br/><input type="button" value="Discussion Group" onclick="showGroup()"/><br/><input type="button" value="Slides" onclick="showSlides()"/></div></p></div></blockquote><blockquote class="LessonBoundary"><div class="BootstrapPageTitle">The Distance Formula</div><div class="content"><div class="overview"><span class="BootstrapLogo"><p><img src="logo.png" alt="bootstrap logo" width="150" height="150"/></p></span><span class="BootstrapLessonTitle"><span class="BSLessonName"><p>Overview</p></span></span><p>Using the Pythagorean theorem and what they know from Bootstrap:Algebra, students write a distance function for their games</p><div class="LessonLearningObjectives"><p><span style="font-weight: bold">Learning Objectives</span></p><ul></ul></div><div class="LessonEvidenceStatementes"><p><span style="font-weight: bold">Evidence Statementes</span></p><ul></ul></div><div class="LessonProductOutcomes"><p><span style="font-weight: bold">Product Outcomes</span></p><ul></ul></div><div class="LessonMaterials"><p><span style="font-weight: bold">Materials</span></p><ul><li><p>Pens/pencils for the students, fresh whiteboard markers for teachers</p></li><li><p>Class poster (List of rules, design recipe, course calendar)</p></li><li><p>Editing environment (Pyret Editor)</p></li><li><p>Student workbooks</p></li><li><p>Language Table</p></li><li><p>Cutouts of Cat and Dog images</p></li><li><p>Cutouts of Pythagorean Theorem packets [<a href="../../resources/images/pythag1.png" target="_blank">1</a>, <a href="../../resources/images/pythag2.png" target="_blank">2</a>] - 1 per cluster</p></li></ul></div><div class="LessonPreparation"><p><span style="font-weight: bold">Preparation</span></p><ul></ul></div></div><div class="segment"><p><a name="lesson_TheDistanceFormula29651"></a><span></span></p><span class="BootstrapLessonTitle"><span class="BSLessonName"><span class="Slide-Lesson-Title">The Distance Formula</span>



<span class="time">(Time 30 minutes)</span>

</span><p></p></span><ul class="lesson"><li class="lessonItem"><div class="student"><p><span class="slideText"><span class="BootstrapSlideTitle">The Distance Formula</span></span>So far, none of the animations we&rsquo;ve created included any distance or collision-detection functions.
However, if you want to make a game where the player has to hit a target, avoid an enemy, jump onto platforms,
or reach a specific part of the screen, we&rsquo;ll need to account for collisions.  This is going to require a
little math, but luckily it&rsquo;s exactly the same as it was in Bootstrap:Algebra.</p></div><div class="teacher"><p>This lesson is part of a series of features meant to come at the end of the Bootstrap:Reactive units. Once students
have made a number of simple animations and games, they will have <span style="font-style: italic">lots</span> of ideas for what they want to
make next and add to their existing games. We&rsquo;ve included a number of the most requested features in these
lessons. Because each students&rsquo; game will be different, we&rsquo;ve used a Pyret version of the original Ninja Cat
game as an example program, but this lesson can be adapted to add collision detection to any game.</p></div></li><li class="lessonItem"><div class="student"><p><div class="SIntrapara"><img src="pict_2.png" alt="image" width="250" height="121"/>
                                </div><div class="SIntrapara"><div class="activity"><ul><li><p>In the image above, how far apart are the cat and dog?</p></li><li><p>If the cat was moved one space to the right, how far apart would they be?</p></li><li><p>What if the cat and dog switched positions?</p></li></ul></div></div></p><p><div class="SIntrapara">Finding the distance in one dimesion is pretty easy: if the characters are on the same number line, we subtract the <span style="font-style: italic">smaller</span> coordinate from
the <span style="font-style: italic">larger</span> one, and we have our distance.
</div><div class="SIntrapara"><div class="activity"><p>When the cat and dog were switched, did you still subtract the dog&rsquo;s position from the cat&rsquo;s,
or subtract the cat&rsquo;s position from the dog&rsquo;s? Why?</p></div></div></p></div><div class="teacher"><p>Draw a number line on the board, with the cutouts of the cat and dog at the given positions. Ask
students to tell you the distance between them, and move the images accordingly. Having students act
this out can also work well: draw a number line, have two students stand at different points on the
line, using their arms or cutouts to give objects of different sizes. Move students along the number
line until they touch, then compute the distance on the number line.</p></div></li><li class="lessonItem"><div class="student"><p><div class="SIntrapara">Unfortunately, most distances aren&rsquo;t only measured in one dimention. We&rsquo;ll need some code to
 calculate the distance between two points in two dimentions.
<img src="pict_3.png" alt="image" width="200" height="200"/>
</div><div class="SIntrapara"><div class="activity"><ul><li><p>How could you find the distance between the two points shown in this image?</p></li><li><p>How could you find the length of the C, also called the <span class="vocab">Hypotenuse</span>?</p></li></ul></div></div><div class="SIntrapara">Let&rsquo;s start with what we do know: if we treat the x- and y-intercepts of C as lines A and B, we have a right triangle.
</div><div class="SIntrapara"><div class="activity"><p>What is the line-length of A? Would it be different if the triangle pointed downward, and intercepted the point (0, -4)?</p></div></div></p></div><div class="teacher"><p>Draw this image on the board, with the lines labeled "A", "B", and "C".</p></div></li><li class="lessonItem"><div class="student"><p>Ancient civilizations had the same problem: they also struggled to find the distance between points
in two dimensions. Let&#8217;s work through a way to think about this problem: what expression computes
the length of the hypotenuse of a right triangle?</p></div><div class="teacher"><p>This exercise is best done in small groups of students (2-3 per group). Pass out Pythagorean Proof
materials [<a href="../../resources/images/pythag1.png" target="_blank">1</a>,
<a href="../../resources/images/pythag2.png" target="_blank">2</a>] to each group, and have them review all of their materials:</p><ul><li><p>A large, white square with a smaller one drawn inside</p></li><li><p>Four gray triangles, all the same size</p></li></ul><p>Everyone will have a packet with the same materials, but each group&rsquo;s triangles are a little different.
 The activity workes with triangles of all sizes, so each pair will get to test it out on their own triangles.
 Draw the diagram on the board.</p></div></li><li class="lessonItem"><div class="student"><p><img src="pict_4.png" alt="image" width="213" height="193"/>For any right triangle, it is possible to draw a picture where the hypoteneuse
 is used for all four sides of a square. In the diagram shown here, the white square is surrounded by four
 gray, identical right-triangles, each with sides A and B. The square itself has four identical sides of
 length C, which are the hypoteneuses for the triangles. If the area of a square is expressed by
 <script type="math/tex">side * side</script>, then the area of the white space is <script type="math/tex">C^{2}</script>.</p></div><div class="teacher"><p>Have students place their gray triangles onto the paper, to match the diagram.</p></div></li><li class="lessonItem"><div class="student"><p><div class="SIntrapara"><img src="Pythag_anim.gif" alt="" width="200" height="200"/> By moving the gray triangles, it is possible to create two rectangles
 that fit inside the original square. While the space taken up by the triangles has shifted, it hasn&rsquo;t gotten
 any bigger or smaller. Likewise, the white space has been broken into two smaller squares, but in total it
 remains the same size. By using the side-lengths A and B, one can calculate the area of the two squares.
 </div><div class="SIntrapara"><div class="activity"><p>What is the area of the smaller square? The larger square?</p></div></div></p></div><div class="teacher"><p>You may need to explicitly point out that the side-lengths of the triangles can be used as the side-lengths of the squares.</p></div></li><li class="lessonItem"><div class="student"><p><div class="SIntrapara"><img src="pict_5.png" alt="image" width="217" height="203"/>The smaller square has an area of <script type="math/tex">A^{2}</script>, and the larger square has an
 area of <script type="math/tex">B^{2}</script>. Since these squares are just the original square broken up into two pieces, we
 know that the sum of these areas must be equal to the area of the original square:
 <div class="banner"><script type="math/tex">A^{2} + B^{2} = C^{2}</script></div>
 </div><div class="SIntrapara"><div class="activity"><p>Does the same equation work for any values of A and B?</p></div></div></p></div><div class="teacher"></div></li><li class="lessonItem"><div class="student"><p>To get C by itself, we take the square-root of the sum of the areas:
<div class="banner"><script type="math/tex">\sqrt{A^{2} + B^{2}} = C</script></div>
Pythagoras proved that you can get the square of the hypotenuse by adding the squares of the other two
sides. In your games, you&rsquo;re going to use the horizontal and vertical distance between two characters
as the two sides of your triangle, and use the Pythagorean theorem to find the length of that third side.</p></div><div class="teacher"><p>Remind students that A and B are the horizontal and vertical lengths, which are calculated by <tt class="pyret">line-length</tt>.</p></div></li><li class="lessonItem"><div class="student"><p><div class="SIntrapara"><div class="activity"><ul><li><p>Turn to <a href="../../resources/workbook/StudentWorkbook.pdf" target="_blank">Page 45</a> of your workbook - you&rsquo;ll see the formula written out.</p></li><li><p>Draw out the circle of evaluation, starting with the simplest expression you can see first.</p></li><li><p>Once you have the circle of evaluation, translate it into Pyret code at the bottom of the page, starting with
&nbsp;<textarea class="pyret">
check:
  distance(4, 2, 0, 5) is...
end
</textarea></p></li></ul></div></div><div class="SIntrapara">Now you&rsquo;ve got code that tells you the distance between the points (4, 2) and (0, 5). But we want to have it work for <span style="font-style: italic">any</span> two points.
It would be great if we had a function that would just take the x&rsquo;s and y&rsquo;s as input, and do the math for us.</div></p></div><div class="teacher"></div></li><li class="lessonItem"><div class="student"><p><div class="SIntrapara"><div class="activity"><ul><li><p>Turn to <a href="../../resources/workbook/StudentWorkbook.pdf" target="_blank">Page 46</a>, and read the problem statement and
function header carefully.</p></li><li><p>Use the Design Recipe to write your distance function. Feel free to use the work from the
previous page as your first example, and then come up with a new one of your own.</p></li><li><p>When finished, type your <tt class="pyret">distance</tt> functions into your game, and see what happens.</p></li><li><p>Does anything happen when things run into each other?</p></li></ul></div></div><div class="SIntrapara">You still need a function to check whether or not two things are colliding.</div></p></div><div class="teacher"><p>Pay careful attention to the order in which the coordinates are given to the <tt class="pyret">distance</tt> function.
The player&rsquo;s x-coordinate (<tt class="pyret">px</tt>) must be given first, followed by the player&rsquo;s y (<tt class="pyret">py</tt>),
character&rsquo;s x (<tt class="pyret">cx</tt>), and character&rsquo;s y (<tt class="pyret">cy</tt>). Just like with making data structures, order
matters, and the distance function will not work otherwise. Also be sure to check that students are
using <tt class="pyret">num-sqr</tt> and <tt class="pyret">num-sqrt</tt> in the correct places. </p></div></li></ul></div></div></blockquote><blockquote class="LessonBoundary"><div class="BootstrapPageTitle">Collision Detection</div><div class="content"><div class="overview"><span class="BootstrapLogo"><p><img src="logo.png" alt="bootstrap logo" width="150" height="150"/></p></span><span class="BootstrapLessonTitle"><span class="BSLessonName"><p>Overview</p></span></span><p>Students write a collision detection function, and modify their next-state-tick function to handle collisions in their games</p><div class="LessonLearningObjectives"><p><span style="font-weight: bold">Learning Objectives</span></p><ul></ul></div><div class="LessonEvidenceStatementes"><p><span style="font-weight: bold">Evidence Statementes</span></p><ul></ul></div><div class="LessonProductOutcomes"><p><span style="font-weight: bold">Product Outcomes</span></p><ul><li><p>Students add collision-detection to their games</p></li></ul></div><div class="LessonMaterials"><p><span style="font-weight: bold">Materials</span></p><ul><li><p>Pens/pencils for the students, fresh whiteboard markers for teachers</p></li><li><p>Class poster (List of rules, design recipe, course calendar)</p></li><li><p>Editing environment (Pyret Editor)</p></li><li><p>Student workbooks</p></li><li><p>Language Table</p></li><li><p>Student Games <span style="font-style: italic">or</span> the <a href="https://code.pyret.org/editor#share=0B9rKDmABYlJVT1FBd3RpQWFqbGM" target="_blank">Pyret Ninja Cat Starter</a> file preloaded on students&rsquo; machines</p></li></ul></div><div class="LessonPreparation"><p><span style="font-weight: bold">Preparation</span></p><ul></ul></div></div><div class="segment"><p><a name="lesson_CollisionDetection29652"></a><span></span></p><span class="BootstrapLessonTitle"><span class="BSLessonName"><span class="Slide-Lesson-Title">Collision Detection</span>



<span class="time">(Time 30 minutes)</span>

</span><p></p></span><ul class="lesson"><li class="lessonItem"><div class="student"><p><div class="SIntrapara"><span class="slideText"><span class="BootstrapSlideTitle">Collision Detection</span></span>So what do we want to do with this distance?
</div><div class="SIntrapara"><div class="activity"><p>How close should your danger and your player be, before they hit each other?</p></div></div><div class="SIntrapara">At the top of <a href="../../resources/workbook/StudentWorkbook.pdf" target="_blank">Page 47</a> you&rsquo;ll find the Word Problem
for <tt class="pyret">is-collision</tt>.
</div><div class="SIntrapara"><div class="activity"><ul><li><p>Fill in the Contract, two examples, and then write the code. Remember: you WILL need to make use of the <tt class="pyret">distance</tt> function you just wrote!</p></li><li><p>When you&rsquo;re done, type it into your game, underneath <tt class="pyret">distance</tt>.</p></li></ul></div></div></p></div><div class="teacher"><p>Using visual examples, ask students to guess the distance between a danger and a player at
different positions. How far apart do they need to be before one has hit the other? Make sure
students understand what is going on by asking questions: If the collision distance is small,
does that mean the game is hard or easy? What would make it easier?</p></div></li><li class="lessonItem"><div class="student"><p><div class="SIntrapara">Now that you have a function which will check whether two things are colliding, you can use it
       in your game! For extra practice, You can also implement collision detection into this
       <a href="https://code.pyret.org/editor#share=0B9rKDmABYlJVT1FBd3RpQWFqbGM" target="_blank">Pyret Ninja Cat game</a>. This is the program we&rsquo;ll be altering for this lesson, as an example. In Ninja Cat, when the cat collides with the dog, we want to put the dog offscreen so that he can come back to attack again.
</div><div class="SIntrapara"><div class="activity"><p>Out of the major functions in the game (<tt class="pyret">next-state-tick</tt>, <tt class="pyret">draw-state</tt>, or <tt class="pyret">next-state-key</tt>), which do you think you&rsquo;ll need to edit to handle collisions, changing the <tt class="pyret">GameState</tt> when two characters collide?</p></div></div><div class="SIntrapara">We&rsquo;ll need to make some more <tt class="pyret">if</tt> branches for <tt class="pyret">next-state-tick</tt>.</div></p></div><div class="teacher"></div></li><li class="lessonItem"><div class="student"><p><div class="SIntrapara"><div class="activity"><ul><li><p>Start with the test: how could you check whether the cat and dog are colliding? Have you written a function to check that?</p></li><li><p>What do the inputs need to be?</p></li><li><p>How do you get the <tt class="pyret">playery</tt> out of the GameState? <tt class="pyret">playerx</tt>?</p></li><li><p>How do you get the <tt class="pyret">dangerx</tt> out of the GameState? <tt class="pyret">dangery</tt>?</p></li></ul></div></div><div class="SIntrapara">&nbsp;<textarea class="pyret">
if is-collision(
g.playerx,
g.playery,
g.dangerx,
g.dangery):   ...result...
</textarea>
Remember that <tt class="pyret">next-state-tick</tt> produces a GameState, so what function should come first in our result?
&nbsp;<textarea class="pyret">
if is-collision(
  g.playerx,
  g.playery,
  g.dangerx,
  g.dangery):
game(
  ...playerx...,
  ...playery...,
  ...dangerx...,
  ...dangery...,
  ...dangerspeed...
  ...targetx...
  ...targety...
  ...targetspeed...)
</textarea>
                                </div><div class="SIntrapara"><div class="activity"><p>And what should happen when the cat and dog collide? Can you think of a number that puts the dog off the screen on the left side? What about the dog&rsquo;s y-coordinate? We could choose a number and always place it at the same y-coordinate each time, but then the game would be really easy! To make it more challenging, we&rsquo;d like the dog to appear at a <span style="font-style: italic">random</span> y-coordinate each time it collides with the cat. Thankfully, Pyret has a function which produces a random number between zero and its input: <tt class="pyret"># num-random :: Number -&gt; Number</tt></p></div></div><div class="SIntrapara">&nbsp;<textarea class="pyret">
if is-collision(
  g.playerx,
  g.playery,
  g.dangerx,
  g.dangery):
game(
  g.playerx,
  200,
  num-random(480),
  0,
  0,
  g.targetx,
  g.targety,
  g.targetspeed) 
</textarea></div></p></div><div class="teacher"><p>Collision detection must be part of the <tt class="pyret">next-state-tick</tt> function because the game should
be checking for a collision <span style="font-style: italic">each time</span> the GameState is updated, on every tick. Students
may assume that <tt class="pyret">draw-state</tt> should handle collision detection, but point out that the Range
of <tt class="pyret">draw-state</tt> is an Image, and their function must return a new GameState in order to set
the locations of the characters after a collision.</p></div></li><li class="lessonItem"><div class="student"><div class="activity"><p>Once you&rsquo;ve finished, write another branch to check whether the player
and the target have collided. <span style="font-weight: bold">Challenges:</span></p><ul><li><p>Change your first condition so that the danger gets reset only when the player and
danger collide <span style="font-style: italic">AND</span> the cat is jumping. (What must be true about the player&rsquo;s
y-coordinate for it to be jumping?)</p></li><li><p>Add another condition to check whether the player has collided with the danger
while the player is on the ground. This could be a single expression within
<tt class="pyret">next-state-tick</tt>, or you can write a <span class="vocab">helper function</span> called
<tt class="pyret">game-over</tt> to do this work, and use it in other functions as well
(maybe the GameState is drawn differently once the game is over.)</p></li></ul></div></div><div class="teacher"><p>For reference, a complete version of the Pyret Ninja Cat game can be <a href="https://code.pyret.org/editor#share=0B9rKDmABYlJVTjVydm93eGptc0k" target="_blank">found here</a>.</p></div></li></ul></div></div></blockquote><p></p><div id="copyright"><a href="http://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank"><img src="pict_6.png" alt="image" width="88" height="31"/></a>Bootstrap:Reactive by Emma Youndtsmith, Emmanuel Schanzer, Kathi Fisler, Shriram Krishnamurthi, and Joe Politz is licensed under a <a href="http://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">Creative Commons 4.0 Unported License</a>. Based on a work at <a href="http://www.bootstrapworld.org/">www.BootstrapWorld.org</a>. Permissions beyond the scope of this license may be available by contacting <a href="mailto:schanzer@BootstrapWorld.org">schanzer@BootstrapWorld.org</a>.</div></div></div><div id="contextindicator">&nbsp;</div></body></html>