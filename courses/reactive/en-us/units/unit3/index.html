<!DOCTYPE html>
<html moznomarginboxes=""><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>Unit 3: Structures, Reactors, and Animations</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="bootstrap.css" title="default"/><link rel="stylesheet" type="text/css" href="pretty-printing.css" title="default"/><link rel="stylesheet" type="text/css" href="codemirror.css" title="default"/><link rel="stylesheet" type="text/css" href="scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="textbook.css" title="default"/><script type="text/javascript" src="scribble-common.js"></script><script type="text/javascript" src="codemirror.js"></script><script type="text/javascript" src="runmode.js"></script><script type="text/javascript" src="scheme2.js"></script><script type="text/javascript" src="pyret-mode.js"></script><script type="text/javascript" src="bootstraplesson.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML%2Chttp%3A%2F%2Fwww.cs.wpi.edu%2F%7Ekfisler%2Fmathjaxlocal.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="mature"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;">&bull;</td><td></td><td><a href="" class="tocviewselflink" data-pltdoc="x">Unit 3:<span class="mywbr"> &nbsp;</span> Structures, Reactors, and Animations</a></td></tr></table></div></div></div><div class="tocsub"><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber"></span><a href="#%28part._.Unit_3__.Structures__.Reactors__and_.Animations%29" class="tocsubseclink" data-pltdoc="x">Unit 3:<span class="mywbr"> &nbsp;</span> Structures, Reactors, and Animations</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><a name="(part._.Unit_3__.Structures__.Reactors__and_.Animations)"></a><p><script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script><noscript></noscript><script type="text/javascript" src="easyXDM.min.js"></script><noscript></noscript><script type="text/javascript" src="json2.min.js"></script><noscript></noscript><script type="text/javascript" src="wescheme-embedded.js"></script><noscript></noscript><script type="text/javascript" src="bootstrap-helpers.js"></script><noscript></noscript></p><div class="headercontent"><span class="BootstrapTitle"><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="pict.png" alt="image" width="156" height="156"/><span class="TitleUnitNum">Unit 3</span>Structures, Reactors, and Animations</span></div><div class="SubFlow" id="overviewDescr"><span class="BootstrapHeader">Unit Overview</span><p>Students create a complete animation (of a sunset) from scratch, and learn how to use data structures
to capture the essence of an animation. They apply the put-image function to draw single frames from data
structure instances, and write a function to generate new frame data from previous frame data.  They learn
how to use reactors to combine their data and functions into a full running animation.</p></div><blockquote class="OverviewBoundary"><iframe id="forum_embed"></iframe><div class="summary"><div class="" id="BootstrapAgenda"><p>Agenda</p><ul class="BootstrapAgendaList"><li class="BootstrapAgendaListItem"><p><span class="BSLessonDuration">55 min</span><a href="#lesson_AnimationsinPyret68069"><span class="BSLessonName">Animations in Pyret</span></a></p></li><li class="BootstrapAgendaListItem"><p><span class="BSLessonDuration">55 min</span><a href="#lesson_FromAnimationstoStructures68070"><span class="BSLessonName">From Animations to Structures</span></a></p></li><li class="BootstrapAgendaListItem"><p><span class="BSLessonDuration">5 min</span><a href="#lesson_Closing68071"><span class="BSLessonName">Closing</span></a></p></li></ul></div><p><span href="../../../../reactive/en-us/units/unit3/index.html" class="TranslationButton">English</span></p><p><span href="#" class="TranslationButton">add translation</span></p><div id="ProductOutcomes" class=" "><span class="BootstrapHeader">Product Outcomes:</span><ul><li><p>Students create a complete animation of a sunset</p></li><li><p>Students learn to use data structures to model the state of an animation</p></li><li><p>Students develop data structures to capture several pre-defined animations</p></li></ul></div><div id="LearningObjectives" class=" "><span class="BootstrapHeader">Standards and Evidence Statements:</span><p>Standards with prefix BS are specific to Bootstrap; others are from the Common Core. Mouse over each standard to see its corresponding evidence statements. Our <a href="http://www.bootstrapworld.org/materials/Standards.shtml" target="_blank">Standards Document</a> shows which units cover each standard. </p><ul class="LearningObjectivesList"><li class="LearningObjectivesListItem"><div class="LearningObjectivesListItemContents"><p><span style="font-weight: bold">BS-DS.1</span>: The student is able to read data blocks</p><ul class="EvidenceStatementsList"></ul></div></li><li class="LearningObjectivesListItem"><div class="LearningObjectivesListItemContents"><p><span style="font-weight: bold">BS-DS.2</span>: The student is able to solve problems using data structures</p><ul class="EvidenceStatementsList"></ul></div></li><li class="LearningObjectivesListItem"><div class="LearningObjectivesListItemContents"><p><span style="font-weight: bold">BS-IDE</span>: The student is familiar with using a REPL, entering expressions properly, and interpreting error messages</p><ul class="EvidenceStatementsList"></ul></div></li><li class="LearningObjectivesListItem"><div class="LearningObjectivesListItemContents"><p><span style="font-weight: bold">BS-M</span>: The student models a problem in context and determines the data needed to describe the problem</p><ul class="EvidenceStatementsList"></ul></div></li><li class="LearningObjectivesListItem"><div class="LearningObjectivesListItemContents"><p><span style="font-weight: bold">BS-PL.1</span>: The student is familiar with declaring values and applying built-in functions using the programming language</p><ul class="EvidenceStatementsList"></ul></div></li><li class="LearningObjectivesListItem"><div class="LearningObjectivesListItemContents"><p><span style="font-weight: bold">BS-PL.3</span>: The student is able to use the syntax of the programming language to define values and functions</p><ul class="EvidenceStatementsList"></ul></div></li><li class="LearningObjectivesListItem"><div class="LearningObjectivesListItemContents"><p><span style="font-weight: bold">BS-PL.P</span>: The Student is comfortable using the Pyret syntax for the Design Recipe</p><ul class="EvidenceStatementsList"></ul></div></li><li class="LearningObjectivesListItem"><div class="LearningObjectivesListItemContents"><p><span style="font-weight: bold">BS-R</span>: The student is able to write interactive programs using the &rsquo;Reactor&rsquo; construct</p><ul class="EvidenceStatementsList"></ul></div></li></ul></div><span class="BootstrapHeader">Length: 115 Minutes</span><div id="Glossary" class=" "><span class="BootstrapHeader">Glossary:</span><ul><li><p><span class="vocab">data structure</span>: A datatype which packages several datatypes as fields</p></li><li><p><span class="vocab">field</span>: A part of a data structure that has a name and holds a single value of a specified datatype</p></li><li><p><span class="vocab">function</span>: a mathematical object that consumes inputs and produces an output</p></li><li><p><span class="vocab">handler</span>: Connects an event (like a tick or keypress) and a function within a reactor</p></li><li><p><span class="vocab">instance</span>: A specific, packaged value of a data structure that contains other values in its fields</p></li><li><p><span class="vocab">reactor</span>: A value that contains a current state, and functions for updating, drawing, and interacting with that state</p></li><li><p><span class="vocab">state</span>: The value of a changing system at any point in time (ie - a stoplight can be in the &rsquo;red&rsquo;, &rsquo;yellow&rsquo; or &rsquo;green&rsquo; state). In Pyret, the state of a Reactor is it&rsquo;s current value.</p></li></ul></div><div id="Materials" class=" "><span class="BootstrapHeader">Materials:</span><ul><li><p>Pens/pencils for the students, fresh whiteboard markers for teachers</p></li><li><p>Class poster (List of rules, design recipe, course calendar)</p></li><li><p>Editing environment (Pyret Editor)</p></li><li><p>Language Table</p></li></ul></div><div id="Preparation" class=" "><span class="BootstrapHeader">Preparation:</span><ul><li><p>Computer for each student (or pair), running the Pyret Editor</p></li><li><p>The <a href="https://code.pyret.org/editor#share=0B9rKDmABYlJVSm94cFA4T3R2NTA" target="_blank">sunset starter file</a> loaded on student machines</p></li></ul></div><div id="LanguageTable" class=" "><table cellspacing="0" cellpadding="0" class="thetable"><tr><td align="center" class="BootstrapTable"><p class="BootstrapTableHeader">Types</p></td><td align="center" class="BootstrapTable"><p class="BootstrapTableHeader">Functions</p></td><td align="center" class="BootstrapTable"><p class="BootstrapTableHeader">Values</p></td></tr><tr><td align="center" class="BootstrapTable"><p>Number</p></td><td align="center" class="BootstrapTable"><p><tt class="pyret">+ - * / num-sqr num-sqrt</tt></p></td><td align="center" class="BootstrapTable"><p>1 ,4 ,44.6</p></td></tr><tr><td align="center" class="BootstrapTable"><p>String</p></td><td align="center" class="BootstrapTable"><p><tt class="pyret">string-append string-length</tt></p></td><td align="center" class="BootstrapTable"><p> "hello" </p></td></tr><tr><td align="center" class="BootstrapTable"><p>Image</p></td><td align="center" class="BootstrapTable"><p><tt class="pyret">rectangle circle triangle ellipse star text scale rotate put-image</tt></p></td><td align="center" class="BootstrapTable"><p>circle(25, "solid", "red")</p></td></tr></table></div><p><div id="lessonToolbar" class="fixed"><input type="button" valueShow="Show Teacher Notes" valueHide="Hide Teacher Notes" value="Show Teacher Notes" onclick="toggleTeacherNotes(this);"></input><br/><input type="button" value="Discussion Group" onclick="showGroup()"/><br/><input type="button" value="Slides" onclick="showSlides()"/></div></p></div></blockquote><blockquote class="LessonBoundary"><div class="BootstrapPageTitle">Animations in Pyret</div><div class="content"><div class="overview"><span class="BootstrapLogo"><p><img src="logo.png" alt="bootstrap logo" width="150" height="150"/></p></span><span class="BootstrapLessonTitle"><span class="BSLessonName"><p>Overview</p></span></span><div class="LessonLearningObjectives"><p><span style="font-weight: bold">Learning Objectives</span></p><ul><li><p>Capture essence of an animation in a data structure</p></li><li><p>Create images for single frames of an animation</p></li><li><p>Write a function to generate data structure instances for a frame from the instance for the previous frame</p></li><li><p>Use reactors to define animations</p></li><li><p>Understand how animations are built from simple functions</p></li></ul></div><div class="LessonEvidenceStatementes"><p><span style="font-weight: bold">Evidence Statementes</span></p><ul></ul></div><div class="LessonProductOutcomes"><p><span style="font-weight: bold">Product Outcomes</span></p><ul><li><p>Students create a complete animation of a sunset</p></li><li><p>Students learn to use data structures to model the state of an animation</p></li></ul></div><div class="LessonMaterials"><p><span style="font-weight: bold">Materials</span></p><ul><li><p>Pens/pencils for the students, fresh whiteboard markers for teachers</p></li><li><p>Class poster (List of rules, design recipe, course calendar)</p></li><li><p>Editing environment (Pyret Editor)</p></li><li><p>Language Table</p></li></ul></div><div class="LessonPreparation"><p><span style="font-weight: bold">Preparation</span></p><ul><li><p>Computer for each student (or pair), running the Pyret Editor</p></li><li><p>The <a href="https://code.pyret.org/editor#share=0B9rKDmABYlJVSm94cFA4T3R2NTA" target="_blank">sunset starter file</a> loaded on student machines</p></li></ul></div></div><div class="segment"><p><a name="lesson_AnimationsinPyret68069"></a><span></span></p><span class="BootstrapLessonTitle"><span class="BSLessonName"><span class="Slide-Lesson-Title">Animations in Pyret</span>



<span class="time">(Time 55 minutes)</span>

</span><p></p></span><ul class="lesson"><li class="lessonItem"><div class="student"><p><span class="slideText"><span class="BootstrapSlideTitle">Animations in Pyret</span></span>You&rsquo;ve learned how to create data structures, and how to create images. Now it&rsquo;s time to put these together to create an animation in Pyret.  We&rsquo;ll even go a step further than what we did in Bootstrap:Algebra, creating an animation with movement in two dimensions.</p></div><div class="teacher"></div></li><li class="lessonItem"><div class="student"><p>In Bootstrap:Algebra, many decisions about your animation were made for you. We told you how many characters you had and which aspects of them could change during the animation.  The danger always moved in the x-axis, the player always moved in the y-axis.  In Bootstrap:Reactive, we give you much more control of your game: you decide how many characters you will have, and what aspects of them can change (position, color, size, etc).  In order to have this flexibility, we need to do a little more work to set up the animation.  Let&rsquo;s break down an animation to see what we need.</p></div><div class="teacher"></div></li><li class="lessonItem"><div class="student"><p>Let&rsquo;s create an animation of a sunset.  The sun will start at the top-left corner of the screen and fall diagonally down and right across the sky. Here&rsquo;s a running version of the animation we are trying to create. Notice that the sun dips below the horizon in the bottom-right corner.
<div class="banner"><img src="sunset.gif" alt="" width="320" height="240"/></div>
In Bootstrap:Algebra, we talked about how an animation is made of a sequence of images that we flip through quickly.
We continue to think of an animation as a sequence of images in Bootstrap:Reactive. For example, here are the first three frames of the sunset
animation:
 <div class="banner"><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="pict_2.png" alt="image" width="930" height="232"/></div></p></div><div class="teacher"></div></li><li class="lessonItem"><div class="student"><p>Where will we get this sequence of images? We don&rsquo;t want to create them all by hand.
Instead, we want to write programs that will create them for us.
This is the power of computer programming.  It can automate tasks (like creating
new images) that might otherwise be tedious for people to do. There are four steps to creating
animations programs.  You&rsquo;ve actually already done the first three in the first two units, but
now we need to show you how to put them together.</p></div><div class="teacher"><p>This is a key point at which to emphasize why functions are important to computer science.
Computers are good at repetition, but they need instructions
telling them what steps to repeat.  Functions capture those instructions.</p></div></li><li class="lessonItem"><div class="student"><p><div class="SIntrapara"><div class="banner"><span style="font-weight: bold">Step 1: Define the data structure</span></div>
  The first step is to develop a <span class="vocab">data structure</span> for the information that changes across frames.
  To do this, we need to figure out what <span class="vocab">fields</span> our data structure will need.
  </div><div class="SIntrapara"><div class="activity"><p>Turn to <a href="../../resources/workbook/StudentWorkbook.pdf" target="_blank">Page 16</a> in your workbook. Copy the three sunset
images we gave you into the boxes at the top of the worksheet.</p></div></div><div class="SIntrapara">To identify the fields, we have to figure out what information is needed to create each
  frame image. Information that changes from frame to frame must be in the data structure.</div></p><div class="activity"><p>On your worksheet, fill in the table just below the three images to indicate
what information changes across the frames.</p></div><p>Hopefully, you identified two pieces of changing information: the x-coordinate of
  the sun and the y-coordinate of the sun. Each image also contains the horizon (the
  brown rectangle), but that is the same in every frame. Let&rsquo;s write down a data
  structure that captures the two coordinates.</p><div class="activity"><p>Fill in the second table, giving a name and type for each of the x-coordinate and y-coordinate.
Then fill in the <tt class="pyret">SunsetState</tt> data structure definition that we started for you
at the bottom of the page. Use <tt class="pyret">sunset</tt> as the name of the constructor.</p></div><p>You should have come up with something like this: a data block with numbers for the two coordinates.
&nbsp;<textarea class="pyret">
                # a SunsetState is the x-coordinate of the sun
# and the y-coordinate of the sun
                data SunsetState:
                 | sunset(
                     xpos :: Number,
                     ypos :: Number)
                end
</textarea>
 The term <span class="vocab">state</span> is used in computer science to refer to the details of a program
 at a specific point in time.  Here, we use it to refer to the details that are unique to
 a single frame of the animation.</p></div><div class="teacher"><p>We have the students copy the images into the workbook partly to make sure they
understand what images they are working with and partly so that they have a
self-contained worksheet page for later reference.</p><p>We are adopting a convention here, in which we include "State" in the name of the data block,
then use the same base name (without "State") for the constructor.
By not conflating the names here, students should have an easier time distinguishing between
the constructor name and data structure name.</p></div></li><li class="lessonItem"><div class="student"><p><div class="SIntrapara">Any time we make a data structure, we should make some sample <span class="vocab">instances</span>: this helps check
that we have the right fields and gives us data to use in making examples later.
</div><div class="SIntrapara"><div class="activity"><p>At the bottom of the worksheet, use the <tt class="pyret">sunset</tt> constructor to write
write down the <tt class="pyret">SunsetState</tt> instance for the first frame (labeled "Sketch A").
It has x-coordinate 10 and y-coordinate 300.</p></div></div></p></div><div class="teacher"></div></li><li class="lessonItem"><div class="student"><p><div class="banner"><span style="font-weight: bold">Step 2: Draw one frame</span></div>
The second step in making an animation is to write a function that consumes an instance of one state
and produces the image for that instance. We call this function <tt class="pyret">draw-state</tt>. For sunset, <tt class="pyret">draw-state</tt>
takes a <span style="font-style: italic">SunsetState</span> instance and produces an image with the sun at that location
(dipping behind the horizon when low in the sky). This function should use <tt class="pyret">put-image</tt>, as we did with the hikers in unit 1.</p><div class="activity"><p>Go to <a href="../../resources/workbook/StudentWorkbook.pdf" target="_blank">Page 18</a> in your workbook and develop the <tt class="pyret">draw-state</tt> function
described there. Type in your function and use it (in the interactions window) to draw several individual sunset frames.</p></div></div><div class="teacher"><p>You may have noticed that we used <tt class="pyret">SunsetState</tt> instead of <tt class="pyret">sunset</tt> as the domain name.
Remember that <tt class="pyret">sunset</tt> is just the name of the constructor, while <tt class="pyret">SunsetState</tt> is the
name of the type.  We use <tt class="pyret">SunsetState</tt> whenever we need a type name for the domain or range.</p></div></li><li class="lessonItem"><div class="student"><p>We can now draw one frame, but an animation needs many frames. How can we draw multiple frames?
Let&rsquo;s simply the problem a bit: if you have the instance for one frame, how do we compute the instance
for the next frame?  Note we didn&rsquo;t ask how to produce the <span style="font-style: italic">image</span> for the next frame. We only asked
how to produce the next <tt class="pyret">SunsetState</tt> instance.  Why?  We just wrote <tt class="pyret">draw-state</tt>, which
produces the image from a <tt class="pyret">SunsetState</tt>.  So if we can produce the instance for the next
frame, we can use <tt class="pyret">draw-state</tt> to produce the image.</p></div><div class="teacher"><p>Separating the instance from the image of it is key here: when we produce an animation, we actually
produce a sequence of instances, and use <tt class="pyret">draw-state</tt> to produce each one.  Students may
need some practice to think of the instance as separate from the image that goes into the animation.</p></div></li><li class="lessonItem"><div class="student"><p><div class="SIntrapara"><div class="banner"><span style="font-weight: bold">Step 3: Produce the next frame instance</span></div>
The third step in making an animation is to write a function that consumes an instance of one state
and produces the instance for the next state. We call this function <tt class="pyret">next-state-tick</tt>. For sunset,
<tt class="pyret">next-state-tick</tt> takes a <tt class="pyret">SunsetState</tt> instance and produces a <span style="font-style: italic">SunsetState</span>
instance that is just a little lower in the sky.
</div><div class="SIntrapara"><div class="activity"><p>Go to <a href="../../resources/workbook/StudentWorkbook.pdf" target="_blank">Page 19</a> in your workbook and develop the <tt class="pyret">next-state-tick</tt> function
described there. Use the sample <tt class="pyret">SunsetState</tt> instances that you developed in
step 1 as you make your examples of the function. Then, type in the code you have so far (including the data definition for <tt class="pyret">SunsetState</tt> into the <a href="https://code.pyret.org/editor#share=0B9rKDmABYlJVSm94cFA4T3R2NTA" target="_blank">sunset starter file</a>, and make sure
your examples are producing the expected answers.</p></div></div></p></div><div class="teacher"></div></li><li class="lessonItem"><div class="student"><p><div class="SIntrapara">Together, the <tt class="pyret">draw-state</tt> and <tt class="pyret">next-state-tick</tt> functions are the building blocks for an
animation. To start to see how, let&rsquo;s first use these two functions to create the first
several frames of an animation by hand (then we&rsquo;ll show you how to make more frames automatically).
</div><div class="SIntrapara"><div class="activity"><p>Run each of the following expressions in the interactions window in turn. Just copy and
paste them, rather than type them by hand each time:</p><ul><li><p><tt class="pyret">draw-state(sunset(10,300))</tt></p></li><li><p><tt class="pyret">next-state-tick(sunset(10,300))</tt></p></li></ul><p>Now use <tt class="pyret">draw-state</tt> on the result of <tt class="pyret">next-state-tick</tt>, then call
<tt class="pyret">next-state-tick</tt> again:</p><ul><li><p><tt class="pyret">draw-state(sunset(18,296))</tt></p></li><li><p><tt class="pyret">next-state-tick(sunset(18,296))</tt></p></li><li><p><tt class="pyret">draw-state(sunset(26,292))</tt></p></li><li><p><tt class="pyret">next-state-tick(sunset(26,292))</tt></p></li></ul></div></div><div class="SIntrapara">Do you see the sun getting lower in the sky from image to image?
  Do you see how we are creating a "chain" of images by alternating calls
  to <tt class="pyret">draw-state</tt> and <tt class="pyret">next-state-tick</tt>? We use <tt class="pyret">next-state-tick</tt> to
  create the instance for a new frame, then use <tt class="pyret">draw-state</tt> to produce the image
  for that frame.</div></p><p><div class="SIntrapara"><div class="activity"><p>(Optional) Here&rsquo;s another way to see the same sequence of expressions. Run each of the
following expressions in the interactions window in turn. Just copy and
paste them, rather than type them by hand each time:</p><ul><li><p><tt class="pyret">draw-state(sunset(10,300))</tt></p></li><li><p><tt class="pyret">draw-state(next-state-tick(sunset(10,300)))</tt></p></li><li><p><tt class="pyret">draw-state(next-state-tick(next-state-tick(sunset(10,300))))</tt></p></li><li><p><tt class="pyret">draw-state(next-state-tick(next-state-tick(next-state-tick(sunset(10,300)))))</tt></p></li></ul></div></div><div class="SIntrapara">Do you see what this sequence
of expressions does? Each one starts with the sun in the upper-left corner, calls
<tt class="pyret">next-state-tick</tt> one or more times to compute a new position for the sun, then draws the state.
Notice that this sequence only has us write down one <tt class="pyret">SunsetState</tt> instance
explicitly (the first one).  All the others are computed from <tt class="pyret">next-state-tick</tt>.
If we could only get Pyret to keep making these calls for us, and to show us the images
quickly one after the next, we&rsquo;d have an animation!</div></p></div><div class="teacher"><p>These sequences show students how the two functions work together to create an animation.
If you feel the second one that composes <tt class="pyret">next-state-tick</tt> with itself many times is too
complicated for your students, you can skip it. The goal of the second sequence is to show that we
only need an initial instance and the two functions to generate a sequence of images that make
up an animation.</p></div></li><li class="lessonItem"><div class="student"><p><div class="banner"><span style="font-weight: bold">Step 4: Define an animation with a reactor</span></div>
The fourth (and final) step in making an animation is to tell Pyret to create an
animation using an initial <tt class="pyret">SunsetState</tt> instance and our <tt class="pyret">draw-state</tt> and
<tt class="pyret">next-state-tick</tt> functions. To do this, we need a new construct called a
<span class="vocab">reactor</span>. A reactor gathers up the information needed to create an animation:</p><ul><li><p>An instance of the data at the start of the animation</p></li><li><p>(Optional) A function that knows how this data should change automatically as time passes</p></li><li><p>(Optional) A function that knows how to take this data and draw one frame of the animation</p></li></ul></div><div class="teacher"><p>Proceed slowly here &ndash; this is a very abstract concept, so you&rsquo;ll want to do a lot of checking for understanding.</p></div></li><li class="lessonItem"><div class="student"><p>A reactor is designed to "react" to different events. When the computer&rsquo;s clock ticks,
we&rsquo;d like to call <tt class="pyret">next-state-tick</tt> on the reactor&rsquo;s state, and have it update to the next state
automatically. Reactors have event <span class="vocab">handlers</span>, which connect events to functions.</p><p><div class="SIntrapara">Here, we define a reactor named <tt class="pyret">sunset-react</tt> for the sunset animation:
&nbsp;<textarea class="pyret">
sunset-react = reactor:
  init: sunset(10, 300),
  on-tick: next-state-tick,
  to-draw: draw-state
end
</textarea>
<tt class="pyret">init</tt> tells the reactor which instance to use when the program starts. In this example,
the program will start with a <tt class="pyret">SunsetState</tt> instance with the sun at (10, 30). <tt class="pyret">on-tick</tt>
and <tt class="pyret">to-draw</tt> are event <span class="vocab">handlers</span>, which connect <tt class="pyret">tick</tt> and <tt class="pyret">draw</tt> events
to our <tt class="pyret">next-state-tick</tt> and <tt class="pyret">draw-state</tt> functions.
</div><div class="SIntrapara"><div class="activity"><p>Copy this reactor definition into your sunset animation program.</p></div></div></p></div><div class="teacher"><p>The reactor is new to Bootstrap:Reactive. In Bootstrap:Algebra, every student had the same reactor "under the hood",
and had to fill in the handlers. This made it easy to focus on the basics and write those handlers,
but it also meant that everyone&rsquo;s game looked a lot alike!  In Bootstrap:Reactive, however, students get to
customize the states of their reactors, and gives them a lot of flexibility in how to deal with events!</p></div></li><li class="lessonItem"><div class="student"><p><div class="SIntrapara">If you run your sunset program after adding the reactor, nothing seems to happen. We have set
up an animation by defining <tt class="pyret">sunset-react</tt>, but we haven&rsquo;t told Pyret to run it.  You could define
multiple reactors in the same file, so we have to tell Pyret explicitly when we want to run one.
</div><div class="SIntrapara"><div class="activity"><p>Type <tt class="pyret">interact(sunset-react)</tt> in the interactions window to run your sunset animation.</p></div></div></p></div><div class="teacher"><p>The Bootstrap:Algebra teachpacks started the animation automatically.  In Bootstrap:Reactive, you
have to start the animation manually by calling <tt class="pyret">interact</tt>.</p></div></li><li class="lessonItem"><div class="student"><p>What happens when we call <tt class="pyret">interact</tt>?  The following diagram summaries what Pyret does to
run the animation. It
draws the initial instance, then repeatedly calls <tt class="pyret">next-state-tick</tt> and <tt class="pyret">draw-state</tt> to
create and display successive frames of your animation.</p><p><div class="banner"><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="pict_3.png" alt="image" width="1352" height="442"/></div></p><p>These are the same computations you did by hand in the interactions window a little while
ago, but Pyret now automates the cycle of generating and drawing instances.  By having
functions that can generate instances and draw images, we can let the computer do the work of
creating the full animation.</p></div><div class="teacher"><p>This figure may be too complex for some students.  Hopefully it helps you, and perhaps them,
see how an animation arises from the two functions we&rsquo;ve written in this lesson.</p></div></li><li class="lessonItem"><div class="student"><p>Functions are essential to creating animations, because each frame comes from a different <tt class="pyret">SusetState</tt>
instance. The process of drawing each instance is the same, but the instance is different each time.
Functions are computations that we want to perform many times.  In an animation, we perform
the <tt class="pyret">draw-state</tt>and <tt class="pyret">next-state-tick</tt> functions once per frame.  Animations are an
excellent illustration of why functions matter in programming.</p></div><div class="teacher"><p>Whether you are primarily teaching math or CS, helping students see the idea of functions and
repeated computations is a key part of what Bootstrap tries to teach.  Animations are a powerful
illustration of repeated computations that functions can capture naturally.</p></div></li><li class="lessonItem"><div class="student"><p>Summarizing what we have seen so far, we have to write four things in order to make an animation:</p><ol><li><p>Create a <span class="vocab">data structure</span> to hold the information that changes across frames. This information is called the <span class="vocab">state</span>.</p></li><li><p>Write a <span class="vocab">function</span> to generate an image of the current state (we&rsquo;ll call this <tt class="pyret">draw-state</tt>).</p></li><li><p>Write a <span class="vocab">function</span> to generate a new state from a given state (we&rsquo;ll call this <tt class="pyret">next-state-tick</tt>).</p></li><li><p>Define a <span class="vocab">reactor</span> that will use an initial instance of the state and the two functions to create an animation.</p></li></ol><p>At this point, you could create your own animation from scratch by following these four steps.  If you do,
you may find it helpful to use the animation design worksheet on page <a href="../../resources/workbook/StudentWorkbook.pdf" target="_blank">Page 41</a>
in your workbook: it takes you through sketching out your frames, developing the data structure for your
animation state, and writing the functions for the animation. It also gives you a checklist of the four
steps above. The checklist mentions a fifth (optional) step, which involves getting your characters to
respond when the user presses a key.  You&rsquo;ll learn how to do that in the next unit.</p></div><div class="teacher"><p>The animation-design worksheet is a condensed summary of the steps to creating an animation.  If your
students still need more scaffolding, follow the sequence of sheets that we used to develop sunset,
including explicit worksheets for <tt class="pyret">draw-state</tt> and <tt class="pyret">next-state-tick</tt>. If your students are
doing fine without the scaffolding of the design recipe worksheets, the condensed worksheet should
suffice to keep them on track (though they should still write tests and follow the other steps of
the design recipe as they work).</p></div></li><li class="lessonItem"><div class="student"><p>You have just seen the incredible power of functions in programming! Functions let us
<span style="font-style: italic">generate content automatically</span>. In the early days of making cartoons,
artists drew every frame by hand.  They had to decide at the beginning how many frames
to create. Here, we let the computer generate as many frames as we want,
by letting it call <tt class="pyret">next-state-tick</tt> over and over until we stop the animation.
If we want to slow down the sunset, we simply change the new coordinates
within <tt class="pyret">next-state-tick</tt>.  If we start with a larger screen size, the computer
will continue to generate as many images as we need to let the sun drop out of the window.
The computer can give us this flexibility as long as <span style="font-style: italic">we provide a function that tells
the computer how to generate another frame</span>.</p></div><div class="teacher"></div></li></ul></div></div></blockquote><blockquote class="LessonBoundary"><div class="BootstrapPageTitle">From Animations to Structures</div><div class="content"><div class="overview"><span class="BootstrapLogo"><p><img src="logo.png" alt="bootstrap logo" width="150" height="150"/></p></span><span class="BootstrapLessonTitle"><span class="BSLessonName"><p>Overview</p></span></span><div class="LessonLearningObjectives"><p><span style="font-weight: bold">Learning Objectives</span></p><ul><li><p>Students practice identifying the data that underlies animations</p></li></ul></div><div class="LessonEvidenceStatementes"><p><span style="font-weight: bold">Evidence Statementes</span></p><ul></ul></div><div class="LessonProductOutcomes"><p><span style="font-weight: bold">Product Outcomes</span></p><ul><li><p>Students develop data structures to capture several pre-defined animations</p></li></ul></div><div class="LessonMaterials"><p><span style="font-weight: bold">Materials</span></p><ul></ul></div><div class="LessonPreparation"><p><span style="font-weight: bold">Preparation</span></p><ul></ul></div></div><div class="segment"><p><a name="lesson_FromAnimationstoStructures68070"></a><span></span></p><span class="BootstrapLessonTitle"><span class="BSLessonName"><span class="Slide-Lesson-Title">From Animations to Structures</span>



<span class="time">(Time 55 minutes)</span>

</span><p></p></span><ul class="lesson"><li class="lessonItem"><div class="student"><p><span class="slideText"><span class="BootstrapSlideTitle">From Animations to Structures</span></span>You&rsquo;ve learned the components of an animation in Pyret. The data structure for the state lies at the heart of the animation: each of the initial state, the <tt class="pyret">draw-state</tt> function and the <tt class="pyret">next-state-tick</tt> function are based on the data structure you choose. Being able to figure out the data structure you need for an animation is therefore a critical skills in making your own animations.  In this lesson, we are going to practice identifying the data and creating the data structures for various animations. We will not write the entire animation.
We are just going to practice identifying the data and writing the data structures.</p></div><div class="teacher"><p>Figuring out the data structure is actually one of the most creative tasks in programming. More complex problems can be captured through multiple data structures. For example, we might have some information that could be computed from other information, so we have to decide what data to include and what to compute.  Or, we might want to combine multiple smaller data structures into a larger one, having a data structure for a coordinate (with both x- and y-positions), and a data structure for a character that has a coordinate and a color. We don&rsquo;t expect that you can envision all of these possibilities right now.  We do want you to be aware that students may come up with different ideas, and that this is appropriate and interesting at this stage.  Your students can have some valuable discussions about design once they start brainstorming different ways to organize data for a problem.</p></div></li><li class="lessonItem"><div class="student"><p><div class="SIntrapara"><span style="font-weight: bold">Exercise: Jumping Cow</span> &ndash; Look at this animation of a cow jumping over the moon.
<img src="cowjump.gif" alt="" width="320" height="214"/>
</div><div class="SIntrapara"><div class="activity"><p>Go to <a href="../../resources/workbook/StudentWorkbook.pdf" target="_blank">Page 20</a> in the workbook. Draw three frames from this animation.
Choose ones that highlight differences across the frames.
The frames don&rsquo;t need to be consecutive.</p></div></div><div class="SIntrapara">When you chose which frames to draw, did you include ones with different images or heights of the cow?
Choosing images with some variation will help you think through the data in your animation.
</div><div class="SIntrapara"><div class="activity"><p>Fill in the table of what information changes across the frames.</p></div></div><div class="SIntrapara">In this case, the cow&rsquo;s x-coordinate and y-coordinate are both changing. The image changes too,
but the position (coordinates) determines which image to use.  The state data structure therefore
only needs to store the coordinates.
</div><div class="SIntrapara"><div class="activity"><p>Fill in the table of what fields you need for each piece of changing information.
Write a data structure <tt class="pyret">CowState</tt> to capture the data in this animation.</p></div></div></p></div><div class="teacher"><p>If students want to include the image in the state, that is fine too. Examples like this
are good for raising discussion about what parts of an animation depend on one another.
The image doesn&rsquo;t need to be in the state, but it isn&rsquo;t wrong to include it there either.</p></div></li><li class="lessonItem"><div class="student"><p><div class="SIntrapara"><span style="font-weight: bold">Exercise: Falling Person</span> &ndash; Look at this animation of a person falling through the sky while two
birds fly upwards.
<img src="falling.gif" alt="" width="320" height="252"/>
</div><div class="SIntrapara"><div class="activity"><p>Go to <a href="../../resources/workbook/StudentWorkbook.pdf" target="_blank">Page 22</a> in the workbook. Draw three frames from this animation.
Choose ones that highlight differences across the frames.
The frames don&rsquo;t need to be consecutive.</p></div></div><div class="SIntrapara">When you chose which frames to draw, did you include ones with the two birds at different distances from each other?
</div><div class="SIntrapara"><div class="activity"><p>Fill in the table of what information changes across the frames.</p></div></div><div class="SIntrapara">In this case, there are five pieces of information: the y-coordinate of the person,
the x- and y-coordinates of the first bird, and the x- and y-coordinates of the second bird.
Do we really need the x-coordinates of the birds?  They only move in the y-axis, but once they go off screen,
their x-coordinates can change for their next pass upward.  You only notice that the x-axis changes if you
look at frames from multiple passes, rather than three consecutive frames.
</div><div class="SIntrapara"><div class="activity"><p>Fill in the table of what fields you need for each piece of changing information.
Write a data structure <tt class="pyret">FallingState</tt> to capture the data in this animation.</p></div></div></p></div><div class="teacher"></div></li><li class="lessonItem"><div class="student"><p><div class="SIntrapara"><span style="font-weight: bold">Exercise: Pulsing Star</span> &ndash; Look at this animation of a star that pulses as it moves across the sky.
<img src="pulsingstar.gif" alt="" width="320" height="225"/>
</div><div class="SIntrapara"><div class="activity"><p>Go to <a href="../../resources/workbook/StudentWorkbook.pdf" target="_blank">Page 24</a> in the workbook. Draw three frames from this animation.
Choose ones that highlight differences across the frames.
The frames don&rsquo;t need to be consecutive.</p></div></div></p><p>When you chose which frames to draw, did you show the star getting smaller and then getting larger again?</p><div class="activity"><p>Fill in the table of what information changes across the frames.</p></div><p>The x- and y-coordinates of the star change, as does the size of the star. These changes are easy to see across
two frames. Something else changes too, but you have to look across at least three frames to see it. Imagine you
had a single frame with the star at size 25. In the next frame, should the star be larger or smaller? It&rsquo;s hard
to tell, because we don&rsquo;t know whether the star is currently in a "growing" phase or a "shrinking" one.  This
animation actually has a fourth state field: the direction of growth of the star. When the star is getting bigger,
the star&rsquo;s size should increase in the next frame. When the star is getting smaller, the size should decrease in
the next frame.</p><div class="activity"><p>Fill in the table of what fields you need for each piece of changing information.
Write a data structure <tt class="pyret">StarState</tt> to capture the data in this animation.</p></div><p>What type did you choose for the field that tracks the direction of growth?  You have several choices: a boolean
such as <tt class="pyret">is-growing</tt>, a string such as <tt class="pyret">direction</tt> (with values <tt class="pyret">"grow"</tt> or <tt class="pyret">"shrink"</tt>), or
a number such <tt class="pyret">growth-rate</tt> which is the amount to add to the size from state to state (a positive value
grows the star while a negative value shrinks it).  The code for <tt class="pyret">next-state-tick</tt> will be cleaner if you
use the number, but the others make sense before you&rsquo;ve thought ahead to the code.</p></div><div class="teacher"><p>The type for tracking direction of growth gives potential for a good discussion. None of these answers are
wrong.  If they were to use the boolean or the string, however, their <tt class="pyret">next-state-tick</tt> function would
need a conditional to decide whether to add or subtract from the current size.  In this exercise, they
aren&rsquo;t writing the animations, so this is less of an issue. Our real goal is to get them to imagine
animations and to identify the state information that underlies each one.</p></div></li><li class="lessonItem"><div class="student"><p><div class="SIntrapara"><span style="font-weight: bold">Exercise: Light Dimmer</span> &ndash; Look at this animation of a slider to control the brightness of a light.
<img src="dimmer.gif" alt="" width="320" height="317"/>
</div><div class="SIntrapara"><div class="activity"><p>Go to <a href="../../resources/workbook/StudentWorkbook.pdf" target="_blank">Page 26</a> in the workbook. Draw three frames from this animation.
Choose ones that highlight differences across the frames.
The frames don&rsquo;t need to be consecutive.</p></div></div><div class="SIntrapara">When you chose which frames to draw, did you include the far left position when the light goes out? It can be useful
to think about the extreme cases when picking frames to focus on.
</div><div class="SIntrapara"><div class="activity"><p>Fill in the table of what information changes across the frames.</p></div></div><div class="SIntrapara">In this case, we see two things changing: the y-coordinate of the slider and the brightness of the light.
You could have one field for each of these. Or, you could just have a field for the y-coordinate and compute
the brightness from that value (you can control the brightness of a shape by putting a number from 0 to 255
in place of "solid" or "outline" in the arguments to the shape-image functions).
</div><div class="SIntrapara"><div class="activity"><p>Fill in the table of what fields you need for each piece of changing information.
Write a data structure <tt class="pyret">LightState</tt> to capture the data in this animation.</p></div></div></p></div><div class="teacher"><p>As an example of using the transparency argument, <tt class="pyret">circle(25, 150, "white")</tt> creates a semi-bright white circle.</p></div></li><li class="lessonItem"><div class="student"><p><span style="font-weight: bold">Exercise: Pong</span> For a real challenge of your data structure design skills, figure out the world data structure
needed for a single-paddle pong game (a ball bouncing off the walls and a single user-controlled paddle). If
you want to build an entire Pong game, see the optional unit on how to do this.</p></div><div class="teacher"></div></li></ul></div></div></blockquote><blockquote class="LessonBoundary"><div class="BootstrapPageTitle">Closing</div><div class="content"><div class="overview"><span class="BootstrapLogo"><p><img src="logo.png" alt="bootstrap logo" width="150" height="150"/></p></span><span class="BootstrapLessonTitle"><span class="BSLessonName"><p>Overview</p></span></span><div class="LessonLearningObjectives"><p><span style="font-weight: bold">Learning Objectives</span></p><ul></ul></div><div class="LessonEvidenceStatementes"><p><span style="font-weight: bold">Evidence Statementes</span></p><ul></ul></div><div class="LessonProductOutcomes"><p><span style="font-weight: bold">Product Outcomes</span></p><ul></ul></div><div class="LessonMaterials"><p><span style="font-weight: bold">Materials</span></p><ul></ul></div><div class="LessonPreparation"><p><span style="font-weight: bold">Preparation</span></p><ul></ul></div></div><div class="segment"><p><a name="lesson_Closing68071"></a><span></span></p><span class="BootstrapLessonTitle"><span class="BSLessonName"><span class="Slide-Lesson-Title">Closing</span>



<span class="time">(Time 5 minutes)</span>

</span><p></p></span><ul class="lesson"><li class="lessonItem"><div class="student"><p><span class="slideText"><span class="BootstrapSlideTitle">Closing</span></span>You&rsquo;ve learned how to create an animation in Pyret. You&rsquo;ve learned how to create a data structure for
the state of your animation.  You&rsquo;ve written a function to draw the frame for one instance of your state
data.  You&rsquo;ve written another function to produce the state instance for the next frame, and you&rsquo;ve learned how
to write a reactor to create an animation from these pieces. Your state data structures can contain
information far beyond the coordinates for players: you can include images, sizes of characters,
colors of elements, and so on.  Once you control the data structure, you can create much richer animations
than you could in Bootstrap:Algebra. Coming up, we will show you how to use keys to control your players.  Later,
we show you how to add other common game features to your Bootstrap:Reactive programs.</p></div><div class="teacher"><p>Have students volunteer what they learned in this lesson</p></div></li></ul></div></div></blockquote><p></p><div id="copyright"><a href="http://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank"><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="pict_4.png" alt="image" width="94" height="37"/></a>Bootstrap:Reactive by Emma Youndtsmith, Emmanuel Schanzer, Kathi Fisler, Shriram Krishnamurthi, and Joe Politz is licensed under a <a href="http://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">Creative Commons 4.0 Unported License</a>. Based on a work at <a href="http://www.bootstrapworld.org/">www.BootstrapWorld.org</a>. Permissions beyond the scope of this license may be available by contacting <a href="mailto:schanzer@BootstrapWorld.org">schanzer@BootstrapWorld.org</a>.</div></div></div><div id="contextindicator">&nbsp;</div></body></html>